% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FG.R
\name{FG}
\alias{FG}
\alias{FG2}
\title{Flury-Gautschi Common Principal Components}
\usage{
FG(cov_array, P = NULL, M = NULL, maxit = 30L)

FG2(cov_array, P = NULL, M = NULL, maxit = 30L)
}
\arguments{
\item{cov_array}{Numeric 3D array of shape \eqn{P \times P \times M}
containing covariance matrices in its \eqn{M} slices.}

\item{P}{Optional integer specifying the matrix dimension; defaults to
\code{dim(cov_array)[1]}.}

\item{M}{Optional integer specifying the number of matrices/slices; defaults
to \code{dim(cov_array)[3]}.}

\item{maxit}{Integer scalar; number of outer iterations of the algorithm.}
}
\value{
A \eqn{P \times P} numeric matrix of estimated common loadings.
}
\description{
Implements the Flury & Gautschi (1986) iterative algorithm to estimate a
common loading matrix across multiple covariance matrices. Each iteration
cycles over all ordered pairs of variable indices and updates a \(2 \times 2\)
rotation so that the transformed matrices share diagonal structure.
}
\details{
Two solvers are exported:
\describe{
\item{\code{FG()}}{Calls the original implementation in \code{FG.cpp}.}
\item{\code{FG2()}}{Calls the alternative implementation in \code{FG2.cpp} that
follows the same interface but can be used to benchmark or validate the
computation.}
}
}
\examples{
\dontrun{
set.seed(1)
P <- 3
M <- 4
mats <- replicate(M,
    {
        A <- matrix(rnorm(P * P), P, P)
        crossprod(A)
    },
    simplify = FALSE
)
cov_cube <- array(NA_real_, dim = c(P, P, M))
for (k in 1:M) cov_cube[, , k] <- mats[[k]]
FG(cov_cube, maxit = 5)
FG2(cov_cube, maxit = 5)
}

}
\seealso{
\code{\link{CAP_one_component}}, \code{\link{rank_complete_s}}
}
