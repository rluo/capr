% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/boot.R
\name{capr_bootstrap}
\alias{capr_bootstrap}
\title{Bootstrap confidence intervals for CAP coefficients}
\usage{
capr_bootstrap(
  S,
  X,
  fit,
  nboot = 200L,
  weight = NULL,
  level = 0.95,
  max_iter = 50L,
  tol = 1e-06,
  seed = NULL
)
}
\arguments{
\item{S}{Numeric array of shape \eqn{p \times p \times n}, matching the data
used to fit \code{fit}.}

\item{X}{Numeric design matrix with \eqn{n} rows.}

\item{fit}{A \code{\link{capr}} fit containing \code{$B} and \code{$Gamma}.}

\item{nboot}{Number of bootstrap replicates.}

\item{weight}{Optional numeric vector of length \eqn{n} (defaults to the
weights used during the original fit, or 1).}

\item{level}{Confidence level for the returned intervals.}

\item{max_iter}{Maximum Newton iterations for solving \eqn{\beta}.}

\item{tol}{Convergence tolerance for the Newton solver.}

\item{seed}{Optional integer seed for reproducibility.}
}
\value{
A list with:
\item{samples}{Array of dimension \eqn{q \times K \times nboot} storing the
bootstrap coefficient estimates.}
\item{ci_lower, ci_upper}{Matrices \eqn{q \times K} with the lower/upper
confidence limits.}
\item{level}{The requested confidence level.}
}
\description{
Generates bootstrap replicates of the CAP regression coefficients while
holding the fitted directions \eqn{\Gamma} fixed. Each replicate samples the
covariance slices \eqn{S_i} with replacement, projects them onto the fixed
directions to obtain component-specific variances, and re-solves the
\eqn{\beta^{(k)}} equations. Quantile-based confidence intervals are
returned for every predictor/component pair.
}
