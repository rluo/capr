% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simu.R
\name{simu.capr}
\alias{simu.capr}
\title{Simulate Covariate-Assisted Principal Regression Data}
\usage{
simu.capr(seed = 123L, p = 5L, n = 120L)
}
\arguments{
\item{seed}{Integer scalar, random seed for reproducibility (default 123).}

\item{p}{Integer scalar, dimension of the covariance matrices (default 5).}

\item{n}{Integer scalar, number of samples/observations (default 120).}
}
\value{
A list containing:
\item{S}{Numeric 3D array of dimension \eqn{p \times p \times n};
stack of covariance matrices.}
\item{X}{Numeric matrix of dimension \eqn{n \times 2}; design matrix
with intercept column and binary covariate.}
\item{Q}{Numeric matrix of dimension \eqn{p \times p};
orthogonal matrix (eigenvectors of reference covariance).}
\item{BetaMat}{Numeric matrix of dimension \eqn{2 \times p};
true regression coefficients of log-eigenvalues.}
\item{H}{Numeric matrix of dimension \eqn{p \times p};
mean of covariance matrices across all samples.}
\item{p}{Integer; dimension parameter.}
\item{n}{Integer; sample size parameter.}
}
\description{
Generates synthetic data for the CAP (Covariate Assisted Principal Regression)
model. Creates a collection of covariance matrices whose log-spectra vary
linearly with binary covariates.
}
\details{
The generative model:
\itemize{
\item \eqn{\lambda_i = \exp(X_i \beta)} where \eqn{\beta} are the true log-eigenvalues.
\item \eqn{S_i = Q \Lambda_i Q^T}, where \eqn{\Lambda_i = \text{diag}(\lambda_i)}.
\item The true \code{BetaMat} is a fixed \eqn{2 \times p} matrix.
\item Covariates \eqn{X} are: intercept + Bernoulli(0.5).
}
}
\examples{
dat <- simu.capr(seed = 42, p = 5, n = 100)
str(dat)
# S is a 5 x 5 x 100 array of covariance matrices
# X is a 100 x 2 design matrix

}
